<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Data Streaming, Confluent, Kafka, MSDS, University of San Francisco, usfca"><meta name=author content="Jeremy Wenxiao Gu"><link href=https://pandaisfast.github.io/msds682-fall2023-data-streaming/lec2/ rel=canonical><link href=../lec1/assignment/ rel=prev><link href=2.1/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.2"><title>Lecture 2. Apache Kafka Part 1. Basics and Producers - MSDS 682 Data Stream Processing</title><link rel=stylesheet href=../assets/stylesheets/main.d451bc0e.min.css><link rel=stylesheet href=../assets/stylesheets/palette.a5377069.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=deep-orange> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lecture-2-apache-kafka-part-1-basics-and-producers class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="MSDS 682 Data Stream Processing" class="md-header__button md-logo" aria-label="MSDS 682 Data Stream Processing" data-md-component=logo> <img src=../assets/usf_f_c_2c_rgb.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MSDS 682 Data Stream Processing </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Lecture 2. Apache Kafka Part 1. Basics and Producers </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_5 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_4> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_5> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_4 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/pandaisfast/msds682-fall2023-data-streaming title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> pandaisfast/msds682-fall2023-data-streaming </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="MSDS 682 Data Stream Processing" class="md-nav__button md-logo" aria-label="MSDS 682 Data Stream Processing" data-md-component=logo> <img src=../assets/usf_f_c_2c_rgb.png alt=logo> </a> MSDS 682 Data Stream Processing </label> <div class=md-nav__source> <a href=https://github.com/pandaisfast/msds682-fall2023-data-streaming title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> pandaisfast/msds682-fall2023-data-streaming </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=.. class="md-nav__link "> <span class=md-ellipsis> Overview </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../lec1/ class="md-nav__link "> <span class=md-ellipsis> Lec 1: 10/20 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Lec 1: 10/20 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec1/1.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> <li class=md-nav__item> <a href=../lec1/demo_or_exercise/ class=md-nav__link> <span class=md-ellipsis> Demo 1 </span> </a> </li> <li class=md-nav__item> <a href=../lec1/assignment/ class=md-nav__link> <span class=md-ellipsis> Assignment 1 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Lec 2: 10/24 T (Room 529) </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Lec 2: 10/24 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=2.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> <li class=md-nav__item> <a href=../assets/msds-lec2-topic-producer/demo_a_creating_topic/ class=md-nav__link> <span class=md-ellipsis> Notebook - Setup &amp; Creating Topics </span> </a> </li> <li class=md-nav__item> <a href=../assets/msds-lec2-topic-producer/demo_b_producer_async/ class=md-nav__link> <span class=md-ellipsis> Notebook - Asynchronous Producer </span> </a> </li> <li class=md-nav__item> <a href=../assets/msds-lec2-topic-producer/demo_c_producer_compare/ class=md-nav__link> <span class=md-ellipsis> Notebook - Compare Async and Sync Producers </span> </a> </li> <li class=md-nav__item> <a href=demo_or_exercise.md class=md-nav__link> <span class=md-ellipsis> Demo 2A </span> </a> </li> <li class=md-nav__item> <a href=demo_or_exercise_2.md class=md-nav__link> <span class=md-ellipsis> Demo 2B </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../lec3/ class="md-nav__link "> <span class=md-ellipsis> Lec 3: 10/27 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Lec 3: 10/27 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec3/3.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> <li class=md-nav__item> <a href=../lec3/demo_or_exercise.md class=md-nav__link> <span class=md-ellipsis> Demo 3A </span> </a> </li> <li class=md-nav__item> <a href=../lec3/demo_or_exercise_2.md class=md-nav__link> <span class=md-ellipsis> Demo 3B </span> </a> </li> <li class=md-nav__item> <a href=../lec3/assignment.md class=md-nav__link> <span class=md-ellipsis> Assignment 2 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../lec4/ class="md-nav__link "> <span class=md-ellipsis> Lec 4: 10/31 T (Room 529) </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Lec 4: 10/31 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec4/4.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../lec5/ class="md-nav__link "> <span class=md-ellipsis> Lec 5: 11/03 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Lec 5: 11/03 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec5/5.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../lec6/ class="md-nav__link "> <span class=md-ellipsis> Lec 6: 11/07 T (Room 529) </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Lec 6: 11/07 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec6/6.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../lec7/ class="md-nav__link "> <span class=md-ellipsis> Lec 7: 11/10 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Lec 7: 11/10 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec7/7.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../lec8/ class="md-nav__link "> <span class=md-ellipsis> Lec 8: 11/14 T (Room 529) </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Lec 8: 11/14 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec8/8.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10> <div class="md-nav__link md-nav__container"> <a href=../lec9/ class="md-nav__link "> <span class=md-ellipsis> Lec 9: 11/17 F (Room 527) </span> </a> <label class="md-nav__link " for=__nav_10 id=__nav_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Lec 9: 11/17 F (Room 527) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec9/9.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11> <div class="md-nav__link md-nav__container"> <a href=../lec10/ class="md-nav__link "> <span class=md-ellipsis> Lec 10: 11/21 T (Room 529) </span> </a> <label class="md-nav__link " for=__nav_11 id=__nav_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Lec 10: 11/21 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec10/10.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_12> <div class="md-nav__link md-nav__container"> <a href=../lec11/ class="md-nav__link "> <span class=md-ellipsis> Lec 11: 11/24 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_12 id=__nav_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Lec 11: 11/24 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec11/11.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_13> <div class="md-nav__link md-nav__container"> <a href=../lec12/ class="md-nav__link "> <span class=md-ellipsis> Lec 12: 11/28 T (Room 529) </span> </a> <label class="md-nav__link " for=__nav_13 id=__nav_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> Lec 12: 11/28 T (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec12/12.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_14> <div class="md-nav__link md-nav__container"> <a href=../lec13/ class="md-nav__link "> <span class=md-ellipsis> Lec 13: 12/01 F (Room 529) </span> </a> <label class="md-nav__link " for=__nav_14 id=__nav_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_14_label aria-expanded=false> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> Lec 13: 12/01 F (Room 529) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec13/13.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_15> <div class="md-nav__link md-nav__container"> <a href=../lec14/ class="md-nav__link "> <span class=md-ellipsis> Lec 14: 12/05 T (Room 157) </span> </a> <label class="md-nav__link " for=__nav_15 id=__nav_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_15_label aria-expanded=false> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> Lec 14: 12/05 T (Room 157) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lec14/14.1/ class=md-nav__link> <span class=md-ellipsis> Additional Topics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_16> <label class=md-nav__link for=__nav_16 id=__nav_16_label tabindex=0> <span class=md-ellipsis> Course Project </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_16_label aria-expanded=false> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Course Project </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../course_project/project_intro/ class=md-nav__link> <span class=md-ellipsis> Project Introduction </span> </a> </li> <li class=md-nav__item> <a href=../course_project/project_guidelines/ class=md-nav__link> <span class=md-ellipsis> Project Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../course_project/project_examples/ class=md-nav__link> <span class=md-ellipsis> Project Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_17> <div class="md-nav__link md-nav__container"> <a href=../appendix1/ class="md-nav__link "> <span class=md-ellipsis> Appendix 1: Frequently Asked Questions </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_17_label aria-expanded=false> <label class=md-nav__title for=__nav_17> <span class="md-nav__icon md-icon"></span> Appendix 1: Frequently Asked Questions </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_18> <div class="md-nav__link md-nav__container"> <a href=../appendix2/ class="md-nav__link "> <span class=md-ellipsis> Appendix 2: Recommended Courses, Books, Videos, Blogs </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_18_label aria-expanded=false> <label class=md-nav__title for=__nav_18> <span class="md-nav__icon md-icon"></span> Appendix 2: Recommended Courses, Books, Videos, Blogs </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basics-of-apache-kafka class=md-nav__link> Basics of Apache Kafka </a> <nav class=md-nav aria-label="Basics of Apache Kafka"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#introduction-to-apache-kafka class=md-nav__link> Introduction to Apache Kafka </a> </li> <li class=md-nav__item> <a href=#kafka-as-a-stream-processing-powerhouse class=md-nav__link> Kafka as a Stream Processing Powerhouse </a> </li> <li class=md-nav__item> <a href=#main-concepts-and-terminology class=md-nav__link> Main Concepts and Terminology </a> </li> <li class=md-nav__item> <a href=#a-peek-into-kafkas-legacy class=md-nav__link> A Peek into Kafka's Legacy </a> </li> <li class=md-nav__item> <a href=#examples-of-managing-topics class=md-nav__link> Examples of Managing Topics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#producers class=md-nav__link> Producers </a> <nav class=md-nav aria-label=Producers> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples-of-writing-producers class=md-nav__link> Examples of Writing Producers </a> </li> <li class=md-nav__item> <a href=#asynchronous-producer-and-synchronous-producer class=md-nav__link> Asynchronous Producer and Synchronous Producer </a> </li> <li class=md-nav__item> <a href=#producer-congiuration class=md-nav__link> Producer Congiuration </a> <nav class=md-nav aria-label="Producer Congiuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#choice-of-compression-types class=md-nav__link> Choice of Compression Types </a> </li> <li class=md-nav__item> <a href=#clientid class=md-nav__link> client.id </a> </li> <li class=md-nav__item> <a href=#idempotence class=md-nav__link> Idempotence </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#producer-batch class=md-nav__link> Producer - Batch </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=lecture-2-apache-kafka-part-1-basics-and-producers>Lecture 2. Apache Kafka Part 1. Basics and Producers</h1> <p>(Working In Progress)</p> <p>Author: Jeremy Gu</p> <h2 id=basics-of-apache-kafka>Basics of Apache Kafka</h2> <p>Before delving into the intricate details of Apache Kafka, it's essential to lay down a broad overview. Starting with a holistic understanding of key concepts will keep us anchored and ensure that we don't get lost. Given that the version of Kafka we're using is continually evolving, we'll heavily reference official definitions and explanations to avoid redundancy. </p> <p>For this course, we'll be working with the latest Kafka version <code>3.6</code>. We encourage you to familiarize yourself with our recommended readings ahead of the class.</p> <p><strong>Recommended Reading</strong>:</p> <ul> <li><strong>Kafka Official Documentation</strong> (Version: Kafka 3.6) at https://kafka.apache.org/documentation/. <strong>Credits:</strong> Any text in <em>italics</em> throughout this document is sourced directly from the Kafka Official Documentation.</li> </ul> <h3 id=introduction-to-apache-kafka>Introduction to Apache Kafka</h3> <ul> <li><strong>Definition:</strong> Apache Kafka is an event streaming platform engineered for real-time collection, processing, storage, and data integration.</li> <li> <p><strong>Officiial Explanation:</strong> From https://kafka.apache.org/, <em>Kafka combines </em><em>three key capabilities</em><em> so you can implement your use cases for event streaming end-to-end with a single battle-tested solution:</em></p> <ul> <li><em>To </em><em>publish</em><em> (write) and </em><em>subscribe</em><em> to (read) streams of events, including continuous import/export of your data from other systems.</em></li> <li><em>To </em><em>store streams</em><em> of events durably and reliably for as long as you want.</em></li> <li><em>To </em><em>process streams</em><em> of events as they occur or retrospectively</em>.</li> </ul> </li> </ul> <h3 id=kafka-as-a-stream-processing-powerhouse>Kafka as a Stream Processing Powerhouse</h3> <ul> <li> <p><strong>Popularity:</strong> Kafka reigns supreme as a leading streaming data platform in the industry, trusted and adopted widely.</p> </li> <li> <p><strong>Beyond Messaging:</strong> While it provides an intuitive <em>message queue</em> interface, Kafka's essence lies in its append-only log-structured storage, transcending traditional messaging paradigms.</p> </li> <li> <p><strong>Events as Kafka’s Core:</strong> </p> <ul> <li>Kafka is fundamentally an event log that chronicles occurrences.</li> <li>These events portray things that have happened, not <strong>directives</strong> for <strong>actions</strong> to be undertaken.</li> <li>An event has a key, value, timestamp, and optional metadata headers. Here's an example event from https://kafka.apache.org/:</li> </ul> </li> </ul> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>Event key: &quot;Alice&quot;
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>Event value: &quot;Made a payment of $200 to Bob&quot;
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>Event timestamp: &quot;Jun. 25, 2020 at 2:06 p.m.&quot;
</span></code></pre></div> <ul> <li> <p><strong>Distributed DNA:</strong> Kafka is innately distributed, fault-tolerant, and scales seamlessly from a single node to a massive thousand-node ensemble. From https://kafka.apache.org/, we have official definitions below.</p> <ul> <li><em>Kafka is a </em><em>distributed system</em><em> consisting of </em><em>servers</em><em> and </em><em>clients</em><em> that communicate via a high-performance TCP network protocol.</em></li> <li><strong>Servers</strong>: <em>Kafka is run as a cluster of one or more servers that can span multiple data centers or cloud regions. Some of these servers form the storage layer, called </em><em>the brokers</em><em>. Other servers run Kafka Connect to continuously import and export data as event streams to integrate Kafka with your existing systems such as relational databases as well as other Kafka clusters.</em></li> <li><strong>Clients</strong> <em>allow you to write distributed applications and microservices that read, write, and process streams of events in parallel, at scale, and in a fault-tolerant manner even in the case of network problems or machine failures.</em></li> </ul> </li> <li> <p><strong>Data Guarantees:</strong> A hallmark of Kafka is its assurance of data order preservation, crucial for deterministic real-time processing tasks.</p> </li> <li> <p><strong>Ecosystem Synergy:</strong> Kafka seamlessly integrates with renowned streaming tools like Apache Spark, Flink, and Samza, broadening its capabilities.</p> </li> </ul> <h3 id=main-concepts-and-terminology>Main Concepts and Terminology</h3> <ul> <li> <p><strong>What is an Event?</strong> <em>An event records the fact that "something happened"</em>.</p> </li> <li> <p><strong>Kafka's Treatment of Events:</strong> </p> <ul> <li><strong>Core Abstraction:</strong> At its core, Kafka offers a distributed commit log, persistently storing events and ensuring their replication.</li> <li><em>Events are organized and durably stored in </em><em>topics</em><em>.</em></li> </ul> </li> <li> <p><strong>Topics:</strong> <em>A topic is similar to a folder in a filesystem, and the events are the files in that folder</em>.</p> <ul> <li><em>Topics are partitioned, meaning a topic is spread over a number of "buckets" located on different Kafka brokers</em> (storage layer).</li> </ul> </li> <li> <p><strong>Producers:</strong> <em>Client applications that publish (write) events to Kafka.</em></p> </li> <li> <p><strong>Consumers:</strong> <em>Client applications that subscribe to (read and process) these events.</em></p> <ul> <li><em>In Kafka, producers and consumers are fully decoupled and agnostic of each other, which is a key design element to achieve the high scalability that Kafka is known for.</em></li> </ul> </li> <li> <p><strong>Source:</strong> Refers to the origin or starting point where data is produced or ingested. In Kafka's ecosystem, a source would typically be a producer or an external system/service that sends data into Kafka. For instance, a database, an application, or any system that produces events could act as a source.</p> </li> <li> <p><strong>Sink:</strong> Refers to the destination or endpoint where data is sent to or consumed. In Kafka, a sink would be the consumer or another data store where Kafka data is written. In the Kafka ecosystem, particularly with Kafka Connect, sinks are often connectors that stream data from Kafka to another system, such as a database, search index, or another type of data store.</p> </li> </ul> <h3 id=a-peek-into-kafkas-legacy>A Peek into Kafka's Legacy</h3> <ul> <li> <p><strong>Birth at LinkedIn:</strong> Kafka was conceived at LinkedIn to cater to their internal streaming requisites. Now, as an Apache Foundation jewel, its adoption and growth are unparalleled.</p> </li> <li> <p><strong>Industry Usage</strong> Titans like Uber, Apple, and Airbnb leverage Kafka for their mission-critical operations, a testament to its robustness.</p> </li> <li> <p><strong>Confluent's Contribution:</strong> After leaving LinkedIn, Kafka's creators founded Confluent. While Kafka remains under the Apache Software Foundation, Confluent significantly influences its development and provides extended tools and support.</p> </li> <li> <p><strong>The Literary Connection:</strong> Kafka owes its name to Czech author <em>Franz Kafka</em>, reflecting its efficient nature of recording events.</p> </li> </ul> <p><strong>Exercise</strong></p> <p>Which of the following messages is more indicative of an event-driven paradigm suitable for a system like Kafka?</p> <p>A. <code>{"directive": "increase_volume", "level": 7}</code></p> <p>B. <code>{"event": "volume_changed", "previous_level": 6, "new_level": 7}</code></p> <p>C. <code>{"message": "Hello World", "recipient": "user123"}</code></p> <details class=note> <summary>Note</summary> <p><strong>Answer</strong>: B. <code>{"event": "volume_changed", "previous_level": 6, "new_level": 7}</code> </p> <p>Explanation: Option B represents a change in state, capturing an "event" of the volume level changing, which aligns well with the event-driven paradigm. Option A seems more like a command or directive, while Option C is a generic message with no clear event or state change described.</p> </details> <h3 id=examples-of-managing-topics>Examples of Managing Topics</h3> <p>(Please read Lecture 2 PPT)</p> <h2 id=producers>Producers</h2> <h3 id=examples-of-writing-producers>Examples of Writing Producers</h3> <p>(Please read Lecture 2 PPT)</p> <h3 id=asynchronous-producer-and-synchronous-producer>Asynchronous Producer and Synchronous Producer</h3> <p>Below is a table that summarizes the use of <code>flush()</code>, <code>poll()</code>, and other methods for both asynchronous and synchronous Kafka producers:</p> <table> <thead> <tr> <th><strong>Method/Action</strong></th> <th><strong>Asynchronous Producer</strong></th> <th><strong>Synchronous Producer</strong></th> </tr> </thead> <tbody> <tr> <td><strong>flush()</strong></td> <td><strong>Used (After all messages)</strong> - Called once after the loop has produced all messages to ensure that all of them have been delivered. It waits up to the given timeout for the delivery report callbacks to be triggered.</td> <td><strong>Used (After each message)</strong> - Called within the loop, after each <code>produce()</code>, to ensure that the current message is delivered and acknowledged before sending the next one.</td> </tr> <tr> <td><strong>poll()</strong></td> <td><strong>Used</strong> - Can be used within the loop or after it, primarily to trigger the delivery report callback and get feedback about the delivery status of messages. If used after the loop (as in the provided example), it will process delivery reports for all previously sent messages.</td> <td><em>Optional</em> - Not typically required in a purely synchronous producer since <code>flush()</code> waits for message acknowledgment. However, if you wanted feedback about delivery status after each message, you could use it.</td> </tr> <tr> <td><strong>callback</strong></td> <td><strong>Used</strong> - Callback functions (like <code>delivery_report</code>) are used to handle delivery reports asynchronously. They provide feedback about the delivery status of each message.</td> <td><em>Optional</em> - While callbacks can be used in synchronous producers, they're not as essential since you're relying on <code>flush()</code> to wait for acknowledgment. However, callbacks can provide more detailed information about the delivery.</td> </tr> </tbody> </table> <p>Remember that in real-world scenarios, you might find hybrid approaches based on the exact requirements of your application. The above distinctions are generalized to help you understand the conceptual differences between the two types of producers.</p> <h3 id=producer-congiuration>Producer Congiuration</h3> <table> <thead> <tr> <th>Configuration</th> <th>Default Value</th> <th>Recommended Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>client.id</code></td> <td>(none)</td> <td>(unique value)</td> <td>Identifier for the client in the Kafka cluster. Useful for tracking and debugging.</td> </tr> <tr> <td><code>retries</code></td> <td>2147483647</td> <td>(depends on use case)</td> <td>The number of retry attempts. A high default ensures durability but can be adjusted based on use case.</td> </tr> <tr> <td><code>enable.idempotence</code></td> <td>false</td> <td>true</td> <td>Ensures that messages are delivered exactly once by allowing retries without duplication.</td> </tr> <tr> <td><code>acks</code></td> <td>all or -1</td> <td>all or -1</td> <td>The number of acknowledgments the producer requires the broker to receive before considering a message sent.</td> </tr> <tr> <td><code>compression.type</code></td> <td>none</td> <td>(depends on use case)</td> <td>Type of compression to use (<code>none</code>, <code>gzip</code>, <code>snappy</code>, <code>lz4</code>, <code>zstd</code>). Chosen based on data and performance needs.</td> </tr> </tbody> </table> <p><a href=https://github.com/confluentinc/librdkafka/blob/master/CONFIGURATION.md>Source of Truth</a> is from the confluent github repo: https://github.com/confluentinc/librdkafka/blob/master/CONFIGURATION.md.</p> <p>Based on <a href=https://www.confluent.io/blog/apache-kafka-message-compression/ >Apache Kafka Message Compression</a> published on 9/18/2023, here are the relevant passages that pertain to the topic-level compression and its precedence:</p> <ol> <li> <p><strong>Topic-Level Compression Precedence</strong>:</p> <blockquote> <p>"Typically, it works in the following manner when the producer is responsible for compression, and the topic’s compression.type is producer."</p> </blockquote> </li> <li> <p><strong>Mismatch in Compression Settings</strong>:</p> <blockquote> <p>"Brokers always perform some amount of batch decompression in order to validate data." "The following scenarios always require full payload decompression: The producer compresses batches (i.e., compression.type isn’t none), and the topic-level compression.type specifies a different codec or is uncompressed."</p> </blockquote> </li> </ol> <h4 id=choice-of-compression-types>Choice of Compression Types</h4> <p>When decompression speed is critical, the following compression algorithms are commonly recommended in Kafka and other systems:</p> <ol> <li> <p><strong>Snappy</strong>: Developed by Google, Snappy prioritizes speed over compression ratio. It doesn't compress as tightly as some other algorithms, but it decompresses very quickly.</p> </li> <li> <p><strong>LZ4</strong>: This is another compression algorithm that's designed for fast decompression speeds. In many benchmarks, LZ4 has been shown to be faster than Snappy, both in terms of compression and decompression, but with a slightly better compression ratio than Snappy.</p> </li> </ol> <p>Between the two, LZ4 is often <strong>recommended</strong> in Kafka for performance reasons, but the best choice can vary depending on the specific nature of the data and the requirements of the use case. Always consider benchmarking with your actual data to determine which one meets your needs best.</p> <p>When network overhead is critical, meaning you want to minimize the amount of data sent over the network, you should opt for compression algorithms that provide the highest compression ratios, even if they are slower in terms of compression and decompression speed. Here are the common choices:</p> <ol> <li> <p><strong>gzip</strong>: This is a widely-used compression algorithm that typically provides a good balance between compression ratio and speed. While it's not the fastest in terms of compression or decompression, it usually achieves smaller compressed sizes compared to faster algorithms like Snappy or LZ4.</p> </li> <li> <p><strong>zstd (Zstandard)</strong>: Developed by Facebook, zstd offers compression ratios comparable to gzip but at much faster speeds, especially in its higher compression levels. This makes zstd a great choice for scenarios where both network bandwidth and speed are concerns.</p> </li> </ol> <p>For maximum reduction in network overhead, you might lean toward gzip or zstd. zstd is often <strong>recommended</strong> over gzip due to its better speed while maintaining a similar, if not better, compression ratio. As always, it's beneficial to benchmark different algorithms with your actual data to determine the best fit for your specific needs.</p> <h4 id=clientid>client.id</h4> <p>The <code>client.id</code> is a configuration setting for Kafka clients (both producers and consumers). It's an identifier for the client in the Kafka cluster. This ID is used in logs, metrics, and for debugging purposes to identify the source of requests to the broker.</p> <p>Having a unique <code>client.id</code> for each client allows administrators and developers to track requests, observe behavior, and troubleshoot issues more effectively because they can see which client is making which requests.</p> <p><strong>Simple Example</strong>: Let's say you have a system with multiple Kafka producers, one that sends user activity data and another that sends system metrics. You can assign unique client IDs to each of them:</p> <ul> <li>For the producer that sends user activity data: <code>client.id=user-activity-producer</code></li> <li>For the producer that sends system metrics: <code>client.id=system-metrics-producer</code></li> </ul> <p>Now, when you look at the logs or metrics from the Kafka broker, you can quickly identify which client (producer) is the source of a particular request or potential issue just by checking the <code>client.id</code>. This is especially helpful in environments with many clients interacting with a Kafka cluster.</p> <h4 id=idempotence>Idempotence</h4> <p>When retries are enabled, enabling idempotence ensures messages remain in their intended order. For example, if messages A, B, and C are sent, but B fails initially while C succeeds, retries without idempotence might lead to an A, C, B order. With idempotence, the order A, B, C is preserved.</p> <h3 id=producer-batch>Producer - Batch</h3> <p>A "batch" itself is a group of messages. </p> <ol> <li> <p><strong>Batching Messages</strong>: Kafka client libraries (producers) don't necessarily send every message individually. Instead, they batch multiple messages together into a single batch for efficiency reasons. This helps in reducing the overhead of network and I/O operations for each message, thus increasing throughput.</p> </li> <li> <p><strong>Batches</strong>: The term "batch" in Kafka's context refers to a collection of messages that are sent together in one go to a Kafka broker. Batching is a technique to improve application and network performance.</p> </li> <li> <p><strong>Customizability</strong>: The way messages are batched and sent — such as the size of the batch (<code>batch.size</code>), the time the producer waits before sending the batch (<code>linger.ms</code>), and the maximum size of a request (<code>max.request.size</code>) — are all customizable using producer configurations.</p> </li> </ol> <p>The belief that the Kafka producer sends messages one by one is incorrect. Here's why:</p> <ul> <li> <p><strong>Batching</strong>: The Kafka producer, including the Python client, doesn't send messages individually. Instead, it groups messages and sends them in batches for efficiency.</p> </li> <li> <p><strong>Configurable Settings</strong>: The conditions for batching, like message count or elapsed time, are adjustable, allowing for performance tuning.</p> </li> <li> <p><strong>Compression</strong>: Kafka can compress these batches, reducing bandwidth usage more effectively than compressing individual messages.</p> </li> <li> <p><strong>Optimized I/O</strong>: Batching reduces the number of I/O operations, improving network and disk efficiency.</p> </li> </ul> <p>In the diagram below, each "Message" represents an individual message produced and ready to be sent. "[ Batch 1 ]" and "[ Batch 2 ]" represent groups of messages that the producer batches together based on certain conditions (like reaching a specific message count, size, or time limit). "Send Batch" represents the action of sending a batch of messages from the producer to the broker.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Producer                                        Broker
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>   |                                              |
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>   |---- Message 1 ----                           |
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>   |---- Message 2 ----                           |
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>   |---- Message 3 ----                           |
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>   |---- Message 4 ----                           |
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>   |                                              |
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>   |                                              |
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>   | Factors for batching:                        |
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>   |   - Count (e.g., 4 messages)                 |
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>   |   - Time (e.g., 500ms elapsed)               |
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>   |   - Size (e.g., nearing 1 GB)                |
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>   |                                              |
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>   |----[ Batch 1 ]----&gt;|------ Send Batch ------&gt;|
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>   |                    |                         |
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>   |---- Message 5 ----                           |
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>   |---- Message 6 ----                           |
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>   |                                              |
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>   |----[ Batch 2 ]----&gt;|------ Send Batch ------&gt;|
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>   |                                              |
</span></code></pre></div> <p><strong>Performance Considerations</strong>: 1) Throughput and 2) Overhead</p> <ul> <li>Batching is largely for performance reasons.</li> <li>In high-throughput applications, sending each message individually would result in significant network overhead.</li> </ul> <p>Here is the <strong>trade-off</strong>: By waiting to accumulate messages, you can send fewer, larger batches, which can improve throughput. However, this could introduce a slight delay in individual message delivery times</p> <p>Official Confluent Documentation: https://docs.confluent.io/platform/current/installation/configuration/producer-configs.html</p> <p>Batch Processing for Efficiency: https://docs.confluent.io/kafka/design/efficient-design.html</p> <p>Tutorial: How to optimize your Kafka producer for throughput: https://developer.confluent.io/tutorials/optimize-producer-throughput/confluent.html</p> <hr> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-10-22T17:41:15-07:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-10-22</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-09-18T07:55:48-07:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-09-18</span> </small> </div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 Jeremy Wenxiao Gu </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tracking", "navigation.indexes", "navigation.top", "navigation.path", "content.tooltips", "content.code.copy"], "search": "../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.726fbb30.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>